<div class="page-container">
  <div class="page-header">
    <h1>Dashboard</h1>
    <div class="header-actions">
      <button mat-stroked-button color="primary" (click)="navigateToEMap()">
        <mat-icon>map</mat-icon>
        View E-Map
      </button>
    </div>
  </div>

  <!-- Summary Cards -->
  <div class="summary-cards">
    <!-- Temperature Status Card -->
    <mat-card class="summary-card">
      <div class="card-icon temp-icon">
        <mat-icon>thermostat</mat-icon>
      </div>
      <div class="card-content">
        <span class="card-title">Temperature Status</span>
        <div class="status-counts">
          <div class="status-item normal">
            <span class="count">{{ summaryCounts.normal }}</span>
            <span class="label">Normal</span>
          </div>
          <div class="status-item warning">
            <span class="count">{{ summaryCounts.warning }}</span>
            <span class="label">Warning</span>
          </div>
          <div class="status-item critical">
            <span class="count">{{ summaryCounts.critical }}</span>
            <span class="label">Critical</span>
          </div>
        </div>
      </div>
    </mat-card>

    <!-- Cameras Card -->
    <mat-card class="summary-card">
      <div class="card-icon camera-icon">
        <mat-icon>videocam</mat-icon>
      </div>
      <div class="card-content">
        <span class="card-title">Thermal Cameras</span>
        <div class="status-counts">
          <div class="status-item connected">
            <span class="count">{{ cameraCounts.connected }}</span>
            <span class="label">Connected</span>
          </div>
          <div class="status-item alert">
            <span class="count">{{ cameraCounts.alert }}</span>
            <span class="label">Alert</span>
          </div>
          <div class="status-item offline">
            <span class="count">{{ cameraCounts.disconnected }}</span>
            <span class="label">Offline</span>
          </div>
        </div>
      </div>
    </mat-card>

    <!-- Sensors Card -->
    <mat-card class="summary-card">
      <div class="card-icon sensor-icon">
        <mat-icon>sensors</mat-icon>
      </div>
      <div class="card-content">
        <span class="card-title">Temperature Sensors</span>
        <div class="status-counts">
          <div class="status-item connected">
            <span class="count">{{ sensorCounts.connected }}</span>
            <span class="label">Connected</span>
          </div>
          <div class="status-item alert">
            <span class="count">{{ sensorCounts.alert }}</span>
            <span class="label">Alert</span>
          </div>
          <div class="status-item offline">
            <span class="count">{{ sensorCounts.disconnected }}</span>
            <span class="label">Offline</span>
          </div>
        </div>
      </div>
    </mat-card>

    <!-- Alerts Card -->
    <mat-card class="summary-card alerts-card" (click)="navigateToAlerts()">
      <div class="card-icon alert-icon" [class.has-alerts]="activeAlertsCount > 0">
        <mat-icon>notifications_active</mat-icon>
      </div>
      <div class="card-content">
        <span class="card-title">Active Alerts</span>
        <div class="alert-count">
          <span class="count" [class.has-alerts]="activeAlertsCount > 0">{{ activeAlertsCount }}</span>
          <span class="label">Require Attention</span>
        </div>
      </div>
      <mat-icon class="card-arrow">chevron_right</mat-icon>
    </mat-card>
  </div>

  <!-- Main Content Grid -->
  <div class="content-grid">
    <!-- Temperature Trend Chart -->
    <mat-card class="chart-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>show_chart</mat-icon>
          Temperature Trend (Last 12 Hours)
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="chart-container">
          <canvas baseChart
            [data]="chartData"
            [options]="chartOptions"
            [type]="chartType">
          </canvas>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Zone Temperatures -->
    <mat-card class="zones-card">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>grid_view</mat-icon>
          Camera Zone Temperatures
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="zones-grid">
          <div *ngFor="let zone of zoneTemperatures" 
               class="zone-item"
               [class.warning]="zone.maxTemp > 40"
               [class.critical]="zone.maxTemp > 50">
            <div class="zone-name">{{ zone.zoneName }}</div>
            <div class="zone-temps">
              <div class="temp-row">
                <span class="temp-label">AVG</span>
                <span class="temp-value">{{ zone.avgTemp | number:'1.1-1' }}째C</span>
              </div>
              <div class="temp-row">
                <span class="temp-label">MIN</span>
                <span class="temp-value min">{{ zone.minTemp | number:'1.1-1' }}째C</span>
              </div>
              <div class="temp-row">
                <span class="temp-label">MAX</span>
                <span class="temp-value max" [class.warning]="zone.maxTemp > 40" [class.critical]="zone.maxTemp > 50">
                  {{ zone.maxTemp | number:'1.1-1' }}째C
                </span>
              </div>
            </div>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

  <!-- Temperature Readings Table -->
  <mat-card class="table-card">
    <mat-card-header>
      <mat-card-title>
        <mat-icon>list</mat-icon>
        Real-time Temperature Readings
      </mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="table-container" *ngIf="!isLoading">
        <table mat-table [dataSource]="temperatureReadings" class="readings-table">
          <!-- Device Name Column -->
          <ng-container matColumnDef="deviceName">
            <th mat-header-cell *matHeaderCellDef>Device</th>
            <td mat-cell *matCellDef="let row">
              <div class="device-cell">
                <mat-icon class="device-icon">{{ row.deviceType === 'sensor' ? 'sensors' : 'videocam' }}</mat-icon>
                <span>{{ row.deviceName }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Value Column -->
          <ng-container matColumnDef="value">
            <th mat-header-cell *matHeaderCellDef>Temperature</th>
            <td mat-cell *matCellDef="let row">
              <span class="temp-value" [class]="getStatusClass(row.status)">
                {{ row.value | number:'1.1-1' }}째{{ row.unit }}
              </span>
            </td>
          </ng-container>

          <!-- Status Column -->
          <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef>Status</th>
            <td mat-cell *matCellDef="let row">
              <div class="status-chip" [class]="getStatusClass(row.status)">
                <mat-icon>{{ getStatusIcon(row.status) }}</mat-icon>
                <span>{{ row.status | titlecase }}</span>
              </div>
            </td>
          </ng-container>

          <!-- Timestamp Column -->
          <ng-container matColumnDef="timestamp">
            <th mat-header-cell *matHeaderCellDef>Last Updated</th>
            <td mat-cell *matCellDef="let row">{{ formatTime(row.timestamp) }}</td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>

      <div class="loading-container" *ngIf="isLoading">
        <mat-spinner diameter="40"></mat-spinner>
        <span>Loading data...</span>
      </div>
    </mat-card-content>
  </mat-card>
</div>


