<div class="page-container">
  <div class="page-header">
    <h1>E-Map</h1>
    <div class="legend">
      <div class="legend-item">
        <span class="legend-dot connected"></span>
        <span>Connected</span>
      </div>
      <div class="legend-item">
        <span class="legend-dot alert"></span>
        <span>Alert</span>
      </div>
      <div class="legend-item">
        <span class="legend-dot disconnected"></span>
        <span>Disconnected</span>
      </div>
    </div>
  </div>

  <div class="map-container">
    <!-- Map Canvas -->
    <mat-card class="map-card">
      <div class="map-canvas">
        <!-- Background grid -->
        <div class="map-grid"></div>
        
        <!-- Substation outline (placeholder) -->
        <div class="substation-layout">
          <div class="area area-transformers">
            <span class="area-label">Transformers</span>
          </div>
          <div class="area area-switchgear">
            <span class="area-label">Switchgear</span>
          </div>
          <div class="area area-cables">
            <span class="area-label">Cable Tunnel</span>
          </div>
          <div class="area area-control">
            <span class="area-label">Control Room</span>
          </div>
        </div>

        <!-- Device markers -->
        <div 
          *ngFor="let device of devices"
          class="device-marker"
          [class]="getStatusClass(device.status)"
          [class.selected]="selectedDevice?.id === device.id"
          [style.left]="getDevicePosition(device).left"
          [style.top]="getDevicePosition(device).top"
          (click)="selectDevice(device)"
          [matTooltip]="device.name"
        >
          <mat-icon>{{ getDeviceIcon(device.type) }}</mat-icon>
          <span class="temp-label" *ngIf="device.temperature">
            {{ device.temperature | number:'1.0-0' }}°
          </span>
        </div>
      </div>
    </mat-card>

    <!-- Device Details Panel -->
    <mat-card class="details-panel" *ngIf="selectedDevice">
      <mat-card-header>
        <mat-card-title>
          <mat-icon>{{ getDeviceIcon(selectedDevice.type) }}</mat-icon>
          {{ selectedDevice.name }}
        </mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="detail-row">
          <span class="label">Type</span>
          <span class="value">{{ selectedDevice.type === 'camera' ? 'Thermal Camera' : 'Temperature Sensor' }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Status</span>
          <span class="value status-badge" [class]="getStatusClass(selectedDevice.status)">
            {{ selectedDevice.status | titlecase }}
          </span>
        </div>
        <div class="detail-row" *ngIf="selectedDevice.temperature">
          <span class="label">Temperature</span>
          <span class="value temp">{{ selectedDevice.temperature | number:'1.1-1' }}°C</span>
        </div>
        <div class="detail-row">
          <span class="label">Position</span>
          <span class="value">X: {{ selectedDevice.position.x }}, Y: {{ selectedDevice.position.y }}</span>
        </div>
      </mat-card-content>
      <mat-card-actions>
        <button mat-stroked-button color="primary">
          <mat-icon>settings</mat-icon>
          Configure
        </button>
        <button mat-stroked-button *ngIf="selectedDevice.type === 'camera'">
          <mat-icon>videocam</mat-icon>
          View Stream
        </button>
      </mat-card-actions>
    </mat-card>

    <!-- Device List -->
    <mat-card class="device-list-card">
      <mat-card-header>
        <mat-card-title>Devices</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="device-list">
          <div 
            *ngFor="let device of devices"
            class="device-list-item"
            [class.selected]="selectedDevice?.id === device.id"
            (click)="selectDevice(device)"
          >
            <mat-icon [class]="getStatusClass(device.status)">{{ getDeviceIcon(device.type) }}</mat-icon>
            <div class="device-info">
              <span class="device-name">{{ device.name }}</span>
              <span class="device-temp" *ngIf="device.temperature">{{ device.temperature | number:'1.1-1' }}°C</span>
            </div>
            <span class="status-dot" [class]="getStatusClass(device.status)"></span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>
</div>


